# **Um Guia Completo Sobre Smart Contracts (Contratos Inteligentes)**

- Em qualquer setor, a automação é uma necessidade, pois as empresas buscam maximizar lucros ao mesmo passo que minimizam despesas;

- Outro motivo para o interesse das organizações em automação é eliminar erros humanos e tornar os processos mais eficientes;

- Existem diversas tecnologias que possibilitam isso, a *Blockchain* é uma delas, oferecendo a automação como uma de suas principais características;

- Os *Smart Contracts* (Contratos Inteligentes) são fundamentais para alcançar essa automação, estando no centro desse conceito.

## **A Definição de *Smart Contract* (Contrato Inteligente)**

- Um *smart contract* (contrato inteligente) é um código digital utilizado para trocar ativos, como ações, dinheiro ou propriedades, sem a necessidade de intermediários;

- Em termos técnicos, é um contrato automatizado ou autoexecutável o qual contém um acordo entre duas partes, codificado de forma digital;

- Os contratos inteligentes são distribuídos, descentralizados e transparentes, pois operam sobre a tecnologia *Blockchain*;

- A ausência de intermediários o torna um conceito revolucionário, pois permite que os contratos funcionem de maneira automática, uma comparação com algo do mundo real seria com documentos fornecidos por advogados;

- A capacidade dos contratos inteligentes de incorporar regras, tanto positivas quanto negativas, é extremamente útil em vários contextos.

![Resumo sobre Smart Contracts][imageOverviewSmartContracts]

## **A Trajetória do Conceito de Contrato Inteligente**

- A ideia de contrato inteligente não é algo novo, ela foi proposta pela primeira vez por ***Nick Szabo*** há duas décadas;

- De acordo com *Szabo*, contratos inteligentes são “um conjunto de promessas especificadas em formato digital”;

- *Nick* *Szabo* é um cientista da computação e criptógrafo que trabalhou em dois tópicos principais:

  * ***Digital Currency*** (**Moeda Digital**);  
  * ***Digital Contracts*** (**Contratos Digitais**).

- Com o seu trabalho, o conceito de contratos inteligentes foi estabelecido com o objetivo de melhorar as práticas de contrato tradicionais para os usuários da internet;

- Esse conceito foi pensado para ser aplicado no *E-commerce* ou *Electronic Commerce* (Comércio Eletrônico);

- Ao longo dos anos, o conceito evoluiu, mas a sua implementação de fato aconteceu com o surgimento da *Blockchain*;

- Quando o *Bitcoin* foi lançado, ele trouxe suporte para contratos inteligentes simples, entretanto, foi o *Ethereum* que consolidou a utilização de contratos inteligentes em casos reais;

- ***Vitalik Buterin***, fundador do *Ethereum*, desempenhou um papel importante nessa evolução, o que pode levar à pergunta “quem inventou os contratos inteligentes?”;

## **A Invenção dos Contratos Inteligentes**

- *Nick Szabo*, cientista da computação americano, propôs o conceito de contratos inteligentes, o seu trabalho envolveu isso e criptografia;

- Em 1998, *Szabo* criou o ***Bit Gold***, uma criptomoeda que definiu os contratos inteligentes como protocolos de transação computacional para execução de contratos;

- Muitas pessoas acabam por confundir *Vitalik Buterin* como o criador dos contratos inteligentes, mas isso não é verdade;

- Porém, ele introduziu uma maneira otimizada de utilizar contratos inteligentes na tecnologia *Blockchain*.

## **Contratos Inteligentes na *Blockchain***

- ***Satoshi Nakamoto*** lançou a primeira criptomoeda em 2008, o ***Bitcoin***, utilizando a revolucionária tecnologia *Blockchain*;

- O protocolo do *Bitcoin* permite a criação de contratos inteligentes simples, no entanto, equipes ao redor do mundo trabalharam na tecnologia para aprimorar sua aplicação no *Bitcoin*;

- Um exemplo disso é a equipe do ***Particl.io***, uma plataforma de *E-commerce* baseada em *Blockchain*;

- Eles habilitaram contratos inteligentes avançados no *Bitcoin*, gerenciando fundos em uma espécie de garantia sem confiança (*trustless escrow*);

- Outro grupo criou o framework **FASTKITTN**, o qual resolveu os desafios de gerenciamento de contratos inteligentes complexos na rede *Bitcoin*, além de reduzir os custos associados;

- Esses avanços foram alcançados utilizando ***Trusted Computing Environments*** (TEEs, Ambientes de Computação Confiáveis, em português) e executando os contratos inteligentes *off-chain* (fora da cadeia), proporcionando mais eficiência e segurança.

### **Contratos Inteligentes no *Ethereum***

- O *Ethereum* revolucionou o funcionamento dos contratos inteligentes no ambiente da *Blockchain*;

- O *Ethereum* foi projetado utilizando contratos inteligentes como base, tornando-os altamentes eficientes dentro do seu ecossistema;

- Atualmente, o *Ethereum* é a principal escolha para a criação de contratos inteligentes.

## **O Funcionamento dos Contratos Inteligentes**

- *Vitalik Buterin* em um ***DC Blockchain Summit***, descreveu os contratos inteligentes como uma forma de transferência de ativos ou moedas dentro de um programa;

- Ele explicou que o programa executa o código com base nas condições definidas nele, feito de maneira automática e verificando as informações fornecidas;

- O contrato inteligente é executado assim que a condição estabelecida for atendida, se a condição não for atendida, o contrato inteligente seguirá as condições previstas no código;

- Outro ponto importante levantado por *Buterin* é que um registro descentralizado cria cópias do contrato inteligente ou documento, garantindo imutabilidade e segurança;

- Embora essa explicação possa parecer muito técnica para quem está começando a explorar o conceito, um exemplo pode ajudar a esclarecer.

### **Exemplo de Contrato Inteligente**

- O setor imobiliário está adotando a tecnologia *Blockchain*, se no futuro você decidir comprar um imóvel por meio de uma plataforma baseada em *Blockchain*, verá os contratos inteligentes em ação;

- Imagine que você encontrou uma propriedade e decidiu comprá-la, há diversos parâmetros que precisam ser definidos em uma negociação imobiliária;

- Por exemplo, é necessário estabelecer o valor do empréstimo, o prazo das parcelas e outras condições específicas;

- Para iniciar o contrato inteligente, você precisa assiná-lo e ativá-lo;

- Por exemplo, você pode optar por pagar 20% do valor do imóvel como entrada e o restante em parcelas, conforme as condições acordadas;

- O vendedor, então, cria um contrato inteligente com base nas condições discutidas;

- O contrato entra em vigor quando ambas as partes confirmam que todos os termos foram documentados corretamente;

- Com o passar do tempo, você realiza os pagamentos, e isso é registrado de maneira automática no contrato inteligente;

- A propriedade é transferida para o seu nome assim que o pagamento total é concluído, todo o processo ocorre automaticamente, sem a intervenção de intermediários ou terceiros;

- Comparado a um processo imobiliário tradicional, esse método economiza tempo e esforço, tanto o comprador quanto o vendedor economizam dinheiro, pois não há intermediários;

- Além disso, o contrato inteligente notifica todas as partes envolvidas sempre que ocorrer algum evento no contrato, incluindo bancos, compradores, vendedores e seguradoras.

## **Um Exemplo Técnico de Contrato Inteligente**

- Um exemplo interessante de contrato inteligente baseado em *Ethereum* está disponível no GitHub da ***Azure***, que oferece uma coleção de exemplos úteis;

- Para ilustrar o conceito de transferência de ativos ou propriedade, considere o exemplo de transferência de ativos fornecido pela *Azure*;

- Nesse cenário, além do **Comprador** (*Buyer*) e do **Vendedor** (*Seller*), dois outros participantes desempenham papéis importantes: o **Avaliador** (*Appraiser*) e o **Inspetor** (*Inspector*);

- O inspetor é responsável por inspecionar os ativos antes da compra pelo comprador;

- O avaliador representa o lado do vendedor, facilitando a venda ao comprador e tornando os ativos mais atraentes;

![Um exemplo técnico de um Smart Contract][imageTechnicalExample]

- O exemplo também inclui múltiplos estados para definir as condições do contrato inteligente, o contrato discutido inclui 10 estados, como:

1. *Active* (Ativo);  
2. *Offer placed* (Oferta colocada);  
3. *Pending inspection* (Inspeção pendente);  
4. *Inspected* (Inspecionado);  
5. *Appraised* (Avaliado);  
6. *Notional acceptance* (Aceitação provisória);  
7. *Seller accepted* (Aceito pelo vendedor);  
8. *Buyer Accepted* (Aceito pelo comprador);  
9. *Terminated* (Encerrado);  
10. *Accepted* (Aceito).

- A lógica do fluxo é complexa e por isso, não será detalhada aqui, entretanto, você pode verificar o `README.md` no [repositório de transferência de ativos](https://github.com/Azure-Samples/blockchain/tree/master/blockchain-workbench/application-and-smart-contract-samples/asset-transfer) para obter mais informações.

## **A Aparência de um Contrato Inteligente**

- Vamos dar uma olhada:

- As primeiras 23 linhas de código do ***Asset Transfer Contract*** **(Contrato de Transferência de Ativos)** são responsáveis por iniciar as variáveis-chave do contrato e incluem o construtor para inicializá-las;

```solidity
pragma solidity >= 0.4.25 < 0.6.0;

contract AssetTransfer {  
    enum StateType { Active, OfferPlaced, PendingInspection, Inspected, Appraised, NotionalAcceptance, BuyerAccepted, SellerAccepted, Accepted, Terminated }  
    address public InstanceOwner;  
    string public Description;  
    uint public AskingPrice;  
    StateType public State;

    address public InstanceBuyer;  
    uint public OfferPrice;  
    address public InstanceInspector;  
    address public InstanceAppraiser;

    constructor(string memory description, uint256 price) public {  
        InstanceOwner = msg.sender;  
        AskingPrice = price;  
        Description = description;  
        State = StateType.Active;  
    }  
}
```

- Além dessa função inicial, há outras importantes, como `MakeOffer` (Fazer Oferta) e `AcceptOffer` (Aceitar Oferta).

### ***MakeOffer***

- Nesta função, a oferta é feita:

```solidity
function MakeOffer (address inspector, address appraiser, uint256 offerPrice) public {  
    if (inspector == 0x0000000000000000000000000000000000000000 || appraiser == 0x0000000000000000000000000000000000000000 || offerPrice == 0) {  
        revert();  
    }  
    if (State != StateType.Active) {  
        revert();  
    }  
    // Não é possível impor "AllowedRoles":["Buyer"] porque as informações da função não estão disponíveis  
    if (InstanceOwner == msg.sender) {  
        revert();  
    }  
    InstanceBuyer = msg.sender;  
    InstanceInspector = inspector;  
    InstanceAppraiser = appraiser;  
    OfferPrice = OfferPrice;  
    State = StateType.OfferPlaced;  
}
```

### ***AcceptOffer*** **e *Reject***

- Essas funções aceitam ou rejeitam a oferta, respectivamente, cada função tem seu propósito específico e na maioria dos casos, elas representam os estados do contrato inteligente.

```solidity
function AcceptOffer() public {  
    if (State != StateType.OfferPlaced) {  
        revert();  
    }  
    if (InstanceOwner != msg.sender) {  
        revert();  
    }  
    State = StateType.PendingInspection;  
}
```

```solidity
function Reject() public {  
    if (State != StateType.OfferPlaced && State != StateType.PendingInspection && State != StateType.Inspected && State != StateType.Appraised && State != StateType.NotionalAcceptance && State != StateType.BuyerAccepted) {  
        revert();  
    }  
    if (InstanceOwner != msg.sender) {  
        revert();  
    }

    InstanceBuyer = 0x0000000000000000000000000000000000000000;  
    State = StateType.Active;  
}
```

- O contrato completo tem 218 linhas de código e inclui várias funções como `MarkInspected`, `MarkAppraised`, entre outras.

## **Vantagens dos Contratos Inteligentes**

- Os contratos inteligentes oferecem as seguintes vantagens:

### **Segurança**

- Os contratos inteligentes fornecem um ambiente seguro para a execução dos contratos, protegendo os detalhes do contrato e outras informações importantes contra vazamentos;

- Além disso, a execução do contrato inteligente não é influenciada por terceiros ou humanos, tornando-o resistente a ataques de hackers, as informações críticas são protegidas por criptografia.

### **Autonomia**

- Contratos inteligentes são autônomos, o que eleva sua funcionalidade a outro nível, uma vez implantados, eles podem se executar e serem concluídos sem interferências.

### **Sem interrupções**

- Os contratos inteligentes não podem ser interrompidos por terceiros, a menos que isso esteja previsto em sua programação inicial.

### **Ambiente sem necessidade de confiança (*Trustless*)**

- Os contratos inteligentes criam um ambiente onde os interesses de todas as partes são protegidos, eliminando a necessidade de confiança mútua.

### **Custo-benefício**

- Por serem autônomos e não exigirem intermediários, os contratos inteligentes reduzem custos operacionais.

### **Alto desempenho**

- Contratos inteligentes podem ser executados em minutos, o que os tornam rápidos, em contraste com as horas ou dias que contratos tradicionais baseados em documentos podem levar.

## **Problemas e Desafios dos Contratos Inteligentes**

- Assim como qualquer outra tecnologia, os contratos inteligentes enfrentam problemas e desafios;

- O mercado está em evolução e muitas empresas ainda estão explorando maneiras de adotar a tecnologia *Blockchain*, porém, a maturidade limitada da tecnologia impacta a adoção dos contratos inteligentes;

- Os principais desafios para os contratos inteligentes são os seguintes:

### **Curva de adoção**

- Como a *Blockchain* ainda está em um estágio inicial, a adoção de contratos inteligentes é impactada;

- As empresas precisam superar muitos desafios para implementar contratos inteligentes, começando pela necessidade de uma rede baseada em registro descentralizado.

### **Questões legais e regulatórias**

- Toda aplicação de contratos inteligentes precisa atender às regulamentações do ecossistema e do local onde será executada.

### **Falta de padronização**

- Os contratos inteligentes ainda não são padronizados, e há diversas abordagens e soluções disponíveis online, o que pode causar confusão.

### **Curva de aprendizado**

- *Blockchain* e contratos inteligentes não são fáceis de dominar, os desenvolvedores precisam não apenas saber programar, mas também compreender aspectos legais relacionados ao contrato;

- Além disso, juízes e agências reguladoras devem ser capazes de interpretar o código, seja por conta própria ou com auxílio.

### **Complexidade do ecossistema empresarial**

- Contratos inteligentes não podem ser adicionados ou executados de forma *ad hoc*, especialmente em ecossistemas empresariais complexos.

### **Privacidade de dados**

- A *Blockchain* é imutável, o que pode entrar em conflito com leis de privacidade de dados, como o GDPR, que permite que usuários solicitem o “esquecimento” dos seus dados;

- Ainda há esforços em andamento para tornar a *Blockchain* mais flexível sem comprometer as suas principais características.

### **Concorrência e expectativas**

- A competição e as expectativas das partes interessadas dificultam a viabilidade dos contratos inteligentes;

- A falta de maturidade e a popularidade da *Blockchain* também impacta sua aceitação no mercado, sendo necessário mais tempo antes que ela seja amplamente adotada.

## **DAML \- Código Aberto para Contratos Inteligentes**

- Nos desafios mencionados, foi destacado o problema da falta de padronização, o DAML busca solucionar essa questão, fornecendo uma linguagem específica para contratos inteligentes;

- Permitindo que desenvolvedores criem aplicações distribuídas de ponta a ponta para *Blockchain*, tecnologias de registro distribuído (DLT) e até mesmo bancos de dados;

- Mas o que torna o DAML tão especial está na sua facilidade, eficiência e segurança;

- Além disso, ele possui um ecossistema robusto que inclui ferramentas como o **DAML IDE**, **DAML *Sandbox***, **DAML *Assistant*** e diversas outras formas de integração;

- No núcleo do DAML, encontra-se sua linguagem, ela suporta recursos-chave que incluem:

  * **Modelo DAML** \- um sistema de tipos poderoso que facilita a definição e apresentação de esquemas de dados complexos, ideal para projetos orientados a domínio;

  * **Permissões detalhadas** \- permite configurar permissões específicas para uma pessoa em um contrato ou parte dele;

  * **Lógica de negócios** \- altamente configurável, possibilitando às empresas mapear sua lógica de negócios de forma perfeita em aplicações distribuídas;

  * **Testes baseados em cenários** \- proporciona total controle para testar diferentes aspectos dos contratos inteligentes e sua funcionalidade.

- Muitas empresas estão ativamente desenvolvendo aplicações completas com o DAML, como ***Accenture***. ***ISDAI***, ***Hashed Health***, ***Change HealthCare***, entre outras;

- Uma das coisas que mais fascina no DAML é o seu suporte a outras tecnologias de registro distribuído, como ***Hyperledger Sawtooth***, ***Amazon Aurora***, ***Hyperledger Fabric***, ***VMWare***, ***Corda***, entre outras.

## **Casos de Uso e Aplicações de Contratos Inteligentes**

- Os contratos inteligentes são extremamente versáteis, ou seja, existem diversas aplicações possíveis para eles;

- Alguns dos cenários onde contratos inteligentes podem ser utilizados são:  
  * Atividades de negociação;  
  * Armazenamento de registros;  
  * Gestão da cadeia de suprimentos;  
  * Mercado imobiliário;  
  * Sistemas de hipoteca;  
  * Proteção de direitos autorais;  
  * Processos de indenização de seguros.

## **DeFi: O Melhor Caso de Uso de Contratos Inteligentes**

- As ***Decentralized Finances*** (**DeFi**, **Finanças Descentralizadas** em português) representam um movimento de código aberto para o setor financeiro;

- Criando um ecossistema onde os usuários podem confiar em aplicativos descentralizados (**DApps**) para atender às suas necessidades financeiras;

- Basicamente, as DeFi oferecem serviços financeiros por meio de uma rede pública e distribuída, que opera sem a necessidade de confiança (*trustless*) e tem maior alcance em comparação às ***Centralized Finances*** (**CeFi**, **Finanças Centralizadas**).

[imageOverviewSmartContracts]: <https://github-production-user-asset-6210df.s3.amazonaws.com/59178745/388762070-b93fe0f4-8dfa-4497-8aaf-d317d040a400.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAVCODYLSA53PQK4ZA%2F20241122%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20241122T014235Z&X-Amz-Expires=300&X-Amz-Signature=ae1a28d039cb044f0133e07571b0f3e4c9cf24e5eae35766202678a3ef90c208&X-Amz-SignedHeaders=host>
[imageTechnicalExample]: <https://github.com/user-attachments/assets/ee21be0b-b794-4dc0-b30b-544b60987e19>